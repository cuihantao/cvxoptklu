

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nonlinear Convex Optimization &mdash; CVXOPT User&#39;s Guide</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="copyright" title="Copyright" href="copyright.html"/>
    <link rel="top" title="CVXOPT User&#39;s Guide" href="index.html"/>
        <link rel="next" title="Modeling" href="modeling.html"/>
        <link rel="prev" title="Cone Programming" href="coneprog.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> CVXOPT User's Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="copyright.html">Copyright and License</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrices.html">Dense and Sparse Matrices</a><ul>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#dense-matrices">Dense Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#sparse-matrices">Sparse Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#arithmetic-operations">Arithmetic Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#indexing-and-slicing">Indexing and Slicing</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#attributes-and-methods">Attributes and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#built-in-functions">Built-In Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#other-matrix-functions">Other Matrix Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="matrices.html#randomly-generated-matrices">Randomly Generated Matrices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="blas.html">The BLAS Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="blas.html#matrix-classes">Matrix Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas.html#level-1-blas">Level 1 BLAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas.html#level-2-blas">Level 2 BLAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="blas.html#level-3-blas">Level 3 BLAS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lapack.html">The LAPACK Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#general-linear-equations">General Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#positive-definite-linear-equations">Positive Definite Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#symmetric-and-hermitian-linear-equations">Symmetric and Hermitian Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#triangular-linear-equations">Triangular Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#least-squares-and-least-norm-problems">Least-Squares and Least-Norm Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#symmetric-and-hermitian-eigenvalue-decomposition">Symmetric and Hermitian Eigenvalue Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#generalized-symmetric-definite-eigenproblems">Generalized Symmetric Definite Eigenproblems</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#singular-value-decomposition">Singular Value Decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#schur-and-generalized-schur-factorization">Schur and Generalized Schur Factorization</a></li>
<li class="toctree-l2"><a class="reference internal" href="lapack.html#example-analytic-centering">Example: Analytic Centering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fftw.html">Discrete Transforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fftw.html#discrete-fourier-transform">Discrete Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="fftw.html#discrete-cosine-transform">Discrete Cosine Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="fftw.html#discrete-sine-transform">Discrete Sine Transform</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spsolvers.html">Sparse Linear Equations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spsolvers.html#matrix-orderings">Matrix Orderings</a></li>
<li class="toctree-l2"><a class="reference internal" href="spsolvers.html#general-linear-equations">General Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="spsolvers.html#positive-definite-linear-equations">Positive Definite Linear Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="spsolvers.html#example-covariance-selection">Example: Covariance Selection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="coneprog.html">Cone Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#linear-cone-programs">Linear Cone Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#quadratic-cone-programs">Quadratic Cone Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#linear-programming">Linear Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#quadratic-programming">Quadratic Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#second-order-cone-programming">Second-Order Cone Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#semidefinite-programming">Semidefinite Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#exploiting-structure">Exploiting Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#optional-solvers">Optional Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="coneprog.html#algorithm-parameters">Algorithm Parameters</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Nonlinear Convex Optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problems-with-nonlinear-objectives">Problems with Nonlinear Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problems-with-linear-objectives">Problems with Linear Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geometric-programming">Geometric Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exploiting-structure">Exploiting Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-parameters">Algorithm Parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modeling.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html#constraints">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html#optimization-problems">Optimization Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeling.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="c-api.html">C API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="c-api.html#dense-matrices">Dense Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="c-api.html#sparse-matrices">Sparse Matrices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="printing.html">Matrix Formatting</a></li>
<li class="toctree-l1"><a class="reference external" href="http://cvxopt.org">cvxopt.org</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">CVXOPT User's Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Nonlinear Convex Optimization</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="nonlinear-convex-optimization">
<span id="c-solvers"></span><h1>Nonlinear Convex Optimization<a class="headerlink" href="#nonlinear-convex-optimization" title="Permalink to this headline">¶</a></h1>
<p>In this chapter we consider nonlinear convex optimization problems of the
form</p>
<div class="math">
<p><img src="_images/math/d76965f1a033d354c739074571c898e2d6d90094.png" alt="\begin{array}{ll}
\mbox{minimize}   &amp; f_0(x) \\
\mbox{subject to} &amp; f_k(x) \leq 0, \quad k=1,\ldots,m \\
                  &amp; G x \preceq h  \\
                  &amp; A x = b.
\end{array}"/></p>
</div><p>The functions <img class="math" src="_images/math/0e154998003cfc278f08dc96371848b75ea42fd9.png" alt="f_k"/> are convex and twice differentiable and the
linear inequalities are generalized inequalities with respect to a proper
convex cone, defined as a product of a nonnegative orthant, second-order
cones, and positive semidefinite cones.</p>
<p>The basic functions are <a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> and
<a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a>, described in the sections
<a class="reference internal" href="#s-cp"><span>Problems with Nonlinear Objectives</span></a> and <a class="reference internal" href="#s-cpl"><span>Problems with Linear Objectives</span></a>.   A simpler interface for geometric
programming problems is discussed in the section <a class="reference internal" href="#s-gp"><span>Geometric Programming</span></a>.
In the section <a class="reference internal" href="#s-nlcp"><span>Exploiting Structure</span></a> we explain how custom solvers can be
implemented that exploit structure in specific classes of problems.
The last section
describes the algorithm parameters that control the solvers.</p>
<div class="section" id="problems-with-nonlinear-objectives">
<span id="s-cp"></span><h2>Problems with Nonlinear Objectives<a class="headerlink" href="#problems-with-nonlinear-objectives" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="cvxopt.solvers.cp">
<code class="descclassname">cvxopt.solvers.</code><code class="descname">cp</code><span class="sig-paren">(</span><em>F</em><span class="optional">[</span>, <em>G</em>, <em>h</em><span class="optional">[</span>, <em>dims</em><span class="optional">[</span>, <em>A</em>, <em>b</em><span class="optional">[</span>, <em>kktsolver</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#cvxopt.solvers.cp" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a convex optimization problem</p>
<div class="math" id="equation-e-nlcp">
<p><span class="eqno">(1)</span><img src="_images/math/e9f7483f134d4b791c23663683f97a82ba62b056.png" alt="\begin{array}{ll}
    \mbox{minimize}   &amp; f_0(x) \\
    \mbox{subject to} &amp; f_k(x) \leq 0, \quad k=1,\ldots,m \\
                      &amp; G x \preceq h  \\
                      &amp; A x = b.
\end{array}"/></p>
</div><p>The argument <code class="docutils literal"><span class="pre">F</span></code> is a function that evaluates the objective and
nonlinear constraint functions.  It must handle the following calling
sequences.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">F()</span></code> returns a tuple (<code class="docutils literal"><span class="pre">m</span></code>, <code class="docutils literal"><span class="pre">x0</span></code>), where <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> is
the number of nonlinear constraints and <img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> is a point in
the domain of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>.  <code class="docutils literal"><span class="pre">x0</span></code> is a dense real matrix of size
(<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1).</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">F(x)</span></code>, with <code class="docutils literal"><span class="pre">x</span></code> a dense real matrix of size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1),
returns a tuple (<code class="docutils literal"><span class="pre">f</span></code>, <code class="docutils literal"><span class="pre">Df</span></code>).  <code class="docutils literal"><span class="pre">f</span></code> is a dense real matrix of
size (<img class="math" src="_images/math/17e7c9a88fff44f20b2b7d58caa082246c177d64.png" alt="m+1"/>, 1), with <code class="docutils literal"><span class="pre">f[k]</span></code> equal to <img class="math" src="_images/math/fb5edeffaf21bca5d920ea2fb9ed088cb574281f.png" alt="f_k(x)"/>.
(If <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> is zero, <code class="docutils literal"><span class="pre">f</span></code> can also be returned as a number.)
<code class="docutils literal"><span class="pre">Df</span></code> is a dense or sparse real matrix of size (<img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> + 1,
<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>) with <code class="docutils literal"><span class="pre">Df[k,:]</span></code> equal to the transpose of the
gradient <img class="math" src="_images/math/562b5099bcca7182c340b5c730982e24aca78314.png" alt="\nabla f_k(x)"/>.  If <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> is not in the domain
of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>, <code class="docutils literal"><span class="pre">F(x)</span></code> returns <code class="xref py py-const docutils literal"><span class="pre">None</span></code> or a tuple
(<code class="xref py py-const docutils literal"><span class="pre">None</span></code>, <code class="xref py py-const docutils literal"><span class="pre">None</span></code>).</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">F(x,z)</span></code>, with <code class="docutils literal"><span class="pre">x</span></code> a dense real matrix of size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1)
and <code class="docutils literal"><span class="pre">z</span></code> a positive dense real matrix of size (<img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> + 1, 1)
returns a tuple (<code class="docutils literal"><span class="pre">f</span></code>, <code class="docutils literal"><span class="pre">Df</span></code>, <code class="docutils literal"><span class="pre">H</span></code>).  <code class="docutils literal"><span class="pre">f</span></code> and <code class="docutils literal"><span class="pre">Df</span></code> are
defined as above.  <code class="docutils literal"><span class="pre">H</span></code> is a square dense or sparse real matrix of
size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>), whose lower triangular part contains
the lower triangular part of</p>
<div class="math">
<p><img src="_images/math/59bb1e408af7fa4b18883af769320f0f79abd8b0.png" alt="z_0 \nabla^2f_0(x) + z_1 \nabla^2f_1(x) + \cdots +
    z_m \nabla^2f_m(x)."/></p>
</div><p>If <code class="docutils literal"><span class="pre">F</span></code> is called with two arguments, it can be assumed that
<img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> is in the domain of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>.</p>
</li>
</ul>
<p>The linear inequalities are with respect to a cone <img class="math" src="_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/> defined
as a Cartesian product of a nonnegative orthant, a number of
second-order cones, and a number of positive semidefinite cones:</p>
<div class="math">
<p><img src="_images/math/ec0606574b5c69317afdafe1c02bce1ce201f7a7.png" alt="C = C_0 \times C_1 \times \cdots \times C_M \times C_{M+1} \times
    \cdots \times C_{M+N}"/></p>
</div><p>with</p>
<div class="math">
<p><img src="_images/math/fcd1cfebe325cf88db061ad2327f0db3a8aba939.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
\newcommand{\svec}{\mathop{\mathbf{vec}}}
\newcommand{\symm}{{\mbox{\bf S}}}
\begin{split}
    C_0 &amp; =
        \{ u \in \reals^l \;| \; u_k \geq 0, \; k=1, \ldots,l\},\\
    C_{k+1} &amp; = \{ (u_0, u_1) \in \reals \times \reals^{r_{k}-1}
        \; | \; u_0 \geq \|u_1\|_2 \},  \quad k=0,\ldots, M-1, \\
    C_{k+M+1} &amp; = \left\{ \svec(u) \; | \; u \in \symm^{t_k}_+
        \right\}, \quad k=0,\ldots,N-1.
\end{split}"/></p>
</div><p>Here <img class="math" src="_images/math/4b78615a721358c983b51554b59f51f691a9494e.png" alt="\mathbf{vec}(u)"/> denotes a symmetric matrix <img class="math" src="_images/math/e5fc41b391867da81606413e3389c7efc73abaf0.png" alt="u"/>
stored as a vector in column major order.</p>
<p>The arguments <code class="docutils literal"><span class="pre">h</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are real single-column dense matrices.
<code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">A</span></code> are real dense or sparse matrices.  The default values
for <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are sparse matrices with zero rows, meaning that
there are no equality constraints.  The number of rows of <code class="docutils literal"><span class="pre">G</span></code> and
<code class="docutils literal"><span class="pre">h</span></code> is equal to</p>
<div class="math">
<p><img src="_images/math/1a6d47f6a30b97355a4f98e1d0a9b292e6d6caf8.png" alt="K = l + \sum_{k=0}^{M-1} r_k + \sum_{k=0}^{N-1} t_k^2."/></p>
</div><p>The columns of <code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">h</span></code> are vectors in</p>
<div class="math">
<p><img src="_images/math/1326e652fceec639bac58f329d8b397f2fe251d2.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
\reals^l \times \reals^{r_0} \times \cdots \times
\reals^{r_{M-1}} \times \reals^{t_0^2}  \times \cdots \times
\reals^{t_{N-1}^2},"/></p>
</div><p>where the last <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> components represent symmetric matrices stored
in column major order.  The strictly upper triangular entries of these
matrices are not accessed (i.e., the symmetric matrices are stored
in the <code class="xref py py-const docutils literal"><span class="pre">'L'</span></code>-type column major order used in the <code class="xref py py-mod docutils literal"><span class="pre">blas</span></code>
and <code class="xref py py-mod docutils literal"><span class="pre">lapack</span></code> modules).</p>
<p>The argument <code class="docutils literal"><span class="pre">dims</span></code> is a dictionary with the dimensions of the cones.
It has three fields.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">dims['l']</span></code>:</dt>
<dd><img class="math" src="_images/math/d99efde75c84ef402a92cd4497530d2366fb112f.png" alt="l"/>, the dimension of the nonnegative orthant (a nonnegative
integer).</dd>
<dt><code class="docutils literal"><span class="pre">dims['q']</span></code>:</dt>
<dd><img class="math" src="_images/math/4a5a1bbcc3881a422d50385a7b28ba2f8b138058.png" alt="[r_0, \ldots, r_{M-1}]"/>, a list with the dimensions of the
second-order cones (positive integers).</dd>
<dt><code class="docutils literal"><span class="pre">dims['s']</span></code>:</dt>
<dd><img class="math" src="_images/math/7949c78c45dd5977a07f55aab72d3f7d7b991f19.png" alt="[t_0, \ldots, t_{N-1}]"/>, a list with the dimensions of the
positive semidefinite cones (nonnegative integers).</dd>
</dl>
<p>The default value of <code class="docutils literal"><span class="pre">dims</span></code> is
<code class="docutils literal"><span class="pre">{'l':</span> <span class="pre">h.size[0],</span> <span class="pre">'q':</span> <span class="pre">[],</span> <span class="pre">'s':</span> <span class="pre">[]}</span></code>, i.e., the default
assumption is that the linear inequalities are componentwise
inequalities.</p>
<p>The role of the optional argument <code class="docutils literal"><span class="pre">kktsolver</span></code> is explained in the
section <a class="reference internal" href="#s-nlcp"><span>Exploiting Structure</span></a>.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">cp</span></code> returns a dictionary that contains the result and
information about the accuracy of the solution.  The most important
fields have keys <code class="xref py py-const docutils literal"><span class="pre">'status'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>.  The
possible values of the <code class="xref py py-const docutils literal"><span class="pre">'status'</span></code> key are:</p>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">'optimal'</span></code></dt>
<dd><p class="first">In this case the <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code> entry of the dictionary is the primal
optimal solution, the <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code> and <code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code> entries are
the corresponding slacks in the nonlinear and linear inequality
constraints, and the <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code> and <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>
entries are the optimal values of the dual variables associated
with the nonlinear inequalities, the linear inequalities, and the
linear equality constraints.  These vectors approximately satisfy
the Karush-Kuhn-Tucker (KKT) conditions</p>
<div class="math">
<p><img src="_images/math/2b2364029e2c1a65dfb62512e8f0c3ab11beb083.png" alt="\nabla f_0(x) +  D\tilde f(x)^T z_\mathrm{nl} +
G^T z_\mathrm{l} + A^T y = 0,

\tilde f(x) + s_\mathrm{nl} = 0, \quad k=1,\ldots,m, \qquad
Gx + s_\mathrm{l} = h, \qquad Ax = b,

s_\mathrm{nl}\succeq 0, \qquad s_\mathrm{l}\succeq 0, \qquad
z_\mathrm{nl} \succeq 0, \qquad z_\mathrm{l} \succeq 0,

s_\mathrm{nl}^T z_\mathrm{nl} +
s_\mathrm{l}^T z_\mathrm{l} = 0"/></p>
</div><p class="last">where <img class="math" src="_images/math/8005301c57dbcd3f8754173aaa142f457c62467a.png" alt="\tilde f = (f_1,\ldots, f_m)"/>.</p>
</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'unknown'</span></code></dt>
<dd>This indicates that the algorithm terminated before a solution was
found, due to numerical difficulties or because the maximum number
of iterations was reached.  The <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>
entries contain the iterates when the algorithm terminated.</dd>
</dl>
<p><code class="xref py py-func docutils literal"><span class="pre">cp</span></code> solves the problem by applying
<a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a> to the epigraph
form problem</p>
<div class="math">
<p><img src="_images/math/03eca013c1b38e9a3853974caeab3eea439da0d9.png" alt="\begin{array}{ll}
\mbox{minimize}   &amp; t \\
\mbox{subject to} &amp; f_0(x) \leq t  \\
                  &amp; f_k(x) \leq 0, \quad k =1, \ldots, m \\
                  &amp; Gx \preceq h \\
                  &amp; Ax = b.
\end{array}"/></p>
</div><p>The other entries in the output dictionary of <code class="xref py py-func docutils literal"><span class="pre">cp</span></code> describe
the accuracy of the solution and are copied from the output of
<a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a> applied to this epigraph form
problem.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">cp</span></code> requires that the problem is strictly primal and dual
feasible and that</p>
<div class="math">
<p><img src="_images/math/87202d921ebebf9a42f0d17a9823a59ee3f5c83c.png" alt="\newcommand{\Rank}{\mathop{\bf rank}}
\Rank(A) = p, \qquad
\Rank \left( \left[ \begin{array}{cccccc}
     \sum_{k=0}^m z_k \nabla^2 f_k(x) &amp; A^T &amp;
      \nabla f_1(x) &amp; \cdots \nabla f_m(x) &amp; G^T
      \end{array} \right] \right) = n,"/></p>
</div><p>for all <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and all positive <img class="math" src="_images/math/84d7271dd9e78c1e05d6c3c6ecb60309ef7dfc73.png" alt="z"/>.</p>
</dd></dl>

<dl class="docutils">
<dt><strong>Example: equality constrained analytic centering</strong></dt>
<dd><p class="first">The equality constrained analytic centering problem is defined as</p>
<div class="math">
<p><img src="_images/math/f760f3b11939823c9b02bad5db429093145730a6.png" alt="\begin{array}{ll}
\mbox{minimize} &amp; -\sum\limits_{i=1}^m \log x_i \\
\mbox{subject to} &amp; Ax = b.
\end{array}"/></p>
</div><p>The function <code class="xref py py-func docutils literal"><span class="pre">acent</span></code> defined  below solves the problem, assuming
it is solvable.</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">solvers</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">spdiag</span><span class="p">,</span> <span class="n">log</span>

<span class="k">def</span> <span class="nf">acent</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">size</span>
    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
        <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">Df</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">spdiag</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span><span class="p">,</span> <span class="n">H</span>
    <span class="k">return</span> <span class="n">solvers</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
<dt><strong>Example: robust least-squares</strong></dt>
<dd><p class="first">The function <code class="xref py py-func docutils literal"><span class="pre">robls</span></code> defined below solves the unconstrained
problem</p>
<div class="math">
<p><img src="_images/math/2c1eb4bcd966e568a1e947d8e1b29f2c87770b90.png" alt="\begin{array}{ll}
\mbox{minimize} &amp;  \sum\limits_{k=1}^m \phi((Ax-b)_k),
\end{array}
\qquad \phi(u) = \sqrt{\rho + u^2},"/></p>
</div><p>where <img class="math" src="_images/math/e558b0b209fc138468737f6695fef0795f8c8336.png" alt="A \in\mathbf{R}^{m\times n}"/>.</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">solvers</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">spdiag</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">div</span>

<span class="k">def</span> <span class="nf">robls</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rho</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">size</span>
    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">b</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">rho</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="n">Df</span> <span class="o">=</span> <span class="n">div</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">A</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">spdiag</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">**-</span><span class="mi">3</span><span class="p">))</span> <span class="o">*</span> <span class="n">A</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span><span class="p">,</span> <span class="n">H</span>
    <span class="k">return</span> <span class="n">solvers</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">F</span><span class="p">)[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Example: analytic centering with cone constraints</strong></p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/8dd73eec3308cda7fab4013f76bc74e4ead2be0d.png" alt="\begin{array}{ll}
\mbox{minimize}
    &amp; -\log(1-x_1^2) -\log(1-x_2^2) -\log(1-x_3^2) \\
\mbox{subject to}
    &amp; \|x\|_2 \leq 1 \\
    &amp; x_1 \left[\begin{array}{rrr}
          -21 &amp; -11 &amp; 0 \\ -11 &amp; 10 &amp; 8 \\ 0 &amp; 8 &amp; 5
           \end{array}\right] +
      x_2 \left[\begin{array}{rrr}
           0 &amp; 10 &amp; 16 \\ 10 &amp; -10 &amp; -10 \\ 16 &amp; -10 &amp; 3
          \end{array}\right] +
      x_3 \left[\begin{array}{rrr}
          -5 &amp; 2 &amp; -17 \\ 2 &amp; -6 &amp; 8 \\ -17 &amp; -7 &amp; 6
          \end{array}\right]
      \preceq \left[\begin{array}{rrr}
          20 &amp; 10 &amp; 40 \\ 10 &amp; 80 &amp; 10 \\ 40 &amp; 10 &amp; 15
          \end{array}\right].
\end{array}"/></p>
</div><div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">spdiag</span><span class="p">,</span> <span class="n">solvers</span>

<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
     <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
     <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="k">return</span> <span class="bp">None</span>
     <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
     <span class="n">val</span> <span class="o">=</span> <span class="o">-</span><span class="nb">sum</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">u</span><span class="p">))</span>
     <span class="n">Df</span> <span class="o">=</span> <span class="n">div</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
     <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="k">return</span> <span class="n">val</span><span class="p">,</span> <span class="n">Df</span>
     <span class="n">H</span> <span class="o">=</span> <span class="n">spdiag</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
     <span class="k">return</span> <span class="n">val</span><span class="p">,</span> <span class="n">Df</span><span class="p">,</span> <span class="n">H</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">21.</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">11.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span>  <span class="mf">16.</span><span class="p">,</span>  <span class="mf">10.</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.</span><span class="p">,</span>  <span class="mf">16.</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">5.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.</span><span class="p">,</span>   <span class="mf">2.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.</span><span class="p">,</span>   <span class="mf">8.</span><span class="p">,</span> <span class="o">-</span><span class="mf">17.</span><span class="p">,</span>  <span class="o">-</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]</span> <span class="p">])</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">])</span>
<span class="n">dims</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;l&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;q&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="s">&#39;s&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">3</span><span class="p">]}</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">dims</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">])</span>
<span class="p">[</span> <span class="mf">4.11e-01</span><span class="p">]</span>
<span class="p">[</span> <span class="mf">5.59e-01</span><span class="p">]</span>
<span class="p">[</span><span class="o">-</span><span class="mf">7.20e-01</span><span class="p">]</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="problems-with-linear-objectives">
<span id="s-cpl"></span><h2>Problems with Linear Objectives<a class="headerlink" href="#problems-with-linear-objectives" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="cvxopt.solvers.cpl">
<code class="descclassname">cvxopt.solvers.</code><code class="descname">cpl</code><span class="sig-paren">(</span><em>c</em>, <em>F</em><span class="optional">[</span>, <em>G</em>, <em>h</em><span class="optional">[</span>, <em>dims</em><span class="optional">[</span>, <em>A</em>, <em>b</em><span class="optional">[</span>, <em>kktsolver</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#cvxopt.solvers.cpl" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a convex optimization problem with a linear objective</p>
<div class="math">
<p><img src="_images/math/fa72eb1a540cebc3dd7afb49700e6c0f08745b5c.png" alt="\begin{array}{ll}
\mbox{minimize}   &amp; c^T x \\
\mbox{subject to} &amp; f_k(x) \leq 0, \quad k=0,\ldots,m-1 \\
                  &amp; G x \preceq h  \\
                  &amp; A x = b.
\end{array}"/></p>
</div><p><code class="docutils literal"><span class="pre">c</span></code> is a real single-column dense matrix.</p>
<p><code class="docutils literal"><span class="pre">F</span></code> is a function that evaluates the nonlinear constraint functions.
It must handle the following calling sequences.</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">F()</span></code> returns a tuple (<code class="docutils literal"><span class="pre">m</span></code>, <code class="docutils literal"><span class="pre">x0</span></code>), where <code class="docutils literal"><span class="pre">m</span></code> is the
number of nonlinear constraints and <code class="docutils literal"><span class="pre">x0</span></code> is a point in the domain
of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>.  <code class="docutils literal"><span class="pre">x0</span></code> is a dense real matrix of size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1).</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">F(x)</span></code>, with <code class="docutils literal"><span class="pre">x</span></code> a dense real matrix of size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1),
returns a tuple (<code class="docutils literal"><span class="pre">f</span></code>, <code class="docutils literal"><span class="pre">Df</span></code>).  <code class="docutils literal"><span class="pre">f</span></code> is a dense real matrix of
size (<img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/>, 1), with <code class="docutils literal"><span class="pre">f[k]</span></code> equal to <img class="math" src="_images/math/fb5edeffaf21bca5d920ea2fb9ed088cb574281f.png" alt="f_k(x)"/>.
<code class="docutils literal"><span class="pre">Df</span></code> is a dense or sparse real matrix of size (<img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/>,
<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>) with <code class="docutils literal"><span class="pre">Df[k,:]</span></code> equal to the transpose of the
gradient <img class="math" src="_images/math/562b5099bcca7182c340b5c730982e24aca78314.png" alt="\nabla f_k(x)"/>.  If <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> is not in the domain
of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>, <code class="docutils literal"><span class="pre">F(x)</span></code> returns <code class="xref py py-const docutils literal"><span class="pre">None</span></code> or a tuple
(<code class="xref py py-const docutils literal"><span class="pre">None</span></code>, <code class="xref py py-const docutils literal"><span class="pre">None</span></code>).</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">F(x,z)</span></code>, with <code class="docutils literal"><span class="pre">x</span></code> a dense real matrix of size (<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, 1)
and <code class="docutils literal"><span class="pre">z</span></code> a positive dense real matrix of size (<img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/>, 1)
returns a tuple (<code class="docutils literal"><span class="pre">f</span></code>, <code class="docutils literal"><span class="pre">Df</span></code>, <code class="docutils literal"><span class="pre">H</span></code>).  <code class="docutils literal"><span class="pre">f</span></code> and <code class="docutils literal"><span class="pre">Df</span></code> are defined
as above.  <code class="docutils literal"><span class="pre">H</span></code> is a square dense or sparse real matrix of size
(<img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>), whose lower triangular part contains the
lower triangular part of</p>
<div class="math">
<p><img src="_images/math/30d55b93201cf02f91a4da14845291a7bc5f2fae.png" alt="z_0 \nabla^2f_0(x) + z_1 \nabla^2f_1(x) + \cdots +
z_{m-1} \nabla^2f_{m-1}(x)."/></p>
</div><p>If <code class="docutils literal"><span class="pre">F</span></code> is called with two arguments, it can be assumed that
<img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> is in the domain of <img class="math" src="_images/math/0001d02b63ede2fe3219e05a7cd09c82ae6298b6.png" alt="f"/>.</p>
</li>
</ul>
<p>The linear inequalities are with respect to a cone <img class="math" src="_images/math/2bcc65482aa8e15cd4c9e9f2542451fb4e971a91.png" alt="C"/> defined as
a Cartesian product of a nonnegative orthant, a number of second-order
cones, and a number of positive semidefinite cones:</p>
<div class="math">
<p><img src="_images/math/c02c277280c0b3f1615a4f191b963a70fb36ecd8.png" alt="C = C_0 \times C_1 \times \cdots \times C_M \times C_{M+1} \times
\cdots \times C_{M+N}"/></p>
</div><p>with</p>
<div class="math">
<p><img src="_images/math/3edfaee3e2a41aade18b71a49c852209260e87c2.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
\newcommand{\svec}{\mathop{\mathbf{vec}}}
\newcommand{\symm}{{\mbox{\bf S}}}
\begin{split}
C_0 &amp;= \{ u \in \reals^l \;| \; u_k \geq 0, \; k=1, \ldots,l\}, \\
C_{k+1} &amp;= \{ (u_0, u_1) \in \reals \times \reals^{r_{k}-1} \; | \;
    u_0 \geq \|u_1\|_2 \},  \quad k=0,\ldots, M-1, \\
C_{k+M+1} &amp;= \left\{ \svec(u) \; | \;
    u \in \symm^{t_k}_+ \right\}, \quad k=0,\ldots,N-1.
\end{split}"/></p>
</div><p>Here <img class="math" src="_images/math/4b78615a721358c983b51554b59f51f691a9494e.png" alt="\mathbf{vec}(u)"/> denotes a symmetric matrix <img class="math" src="_images/math/e5fc41b391867da81606413e3389c7efc73abaf0.png" alt="u"/>
stored as a vector in column major order.</p>
<p>The arguments <code class="docutils literal"><span class="pre">h</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are real single-column dense matrices.
<code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">A</span></code> are real dense or sparse matrices.  The default values
for <code class="docutils literal"><span class="pre">A</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are sparse matrices with zero rows, meaning that
there are no equality constraints.  The number of rows of <code class="docutils literal"><span class="pre">G</span></code> and
<code class="docutils literal"><span class="pre">h</span></code> is equal to</p>
<div class="math">
<p><img src="_images/math/1a6d47f6a30b97355a4f98e1d0a9b292e6d6caf8.png" alt="K = l + \sum_{k=0}^{M-1} r_k + \sum_{k=0}^{N-1} t_k^2."/></p>
</div><p>The columns of <code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">h</span></code> are vectors in</p>
<div class="math">
<p><img src="_images/math/1326e652fceec639bac58f329d8b397f2fe251d2.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
\reals^l \times \reals^{r_0} \times \cdots \times
\reals^{r_{M-1}} \times \reals^{t_0^2}  \times \cdots \times
\reals^{t_{N-1}^2},"/></p>
</div><p>where the last <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> components represent symmetric matrices stored
in column major order.  The strictly upper triangular entries of these
matrices are not accessed (i.e., the symmetric matrices are stored
in the <code class="xref py py-const docutils literal"><span class="pre">'L'</span></code>-type column major order used in the <code class="xref py py-mod docutils literal"><span class="pre">blas</span></code> and
<code class="xref py py-mod docutils literal"><span class="pre">lapack</span></code> modules.</p>
<p>The argument <code class="docutils literal"><span class="pre">dims</span></code> is a dictionary with the dimensions of the cones.
It has three fields.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">dims['l']</span></code>:</dt>
<dd><img class="math" src="_images/math/d99efde75c84ef402a92cd4497530d2366fb112f.png" alt="l"/>, the dimension of the nonnegative orthant (a nonnegative
integer).</dd>
<dt><code class="docutils literal"><span class="pre">dims['q']</span></code>:</dt>
<dd><img class="math" src="_images/math/4a5a1bbcc3881a422d50385a7b28ba2f8b138058.png" alt="[r_0, \ldots, r_{M-1}]"/>, a list with the dimensions of the
second-order cones (positive integers).</dd>
<dt><code class="docutils literal"><span class="pre">dims['s']</span></code>:</dt>
<dd><img class="math" src="_images/math/7949c78c45dd5977a07f55aab72d3f7d7b991f19.png" alt="[t_0, \ldots, t_{N-1}]"/>, a list with the dimensions of the
positive semidefinite cones (nonnegative integers).</dd>
</dl>
<p>The default value of <code class="docutils literal"><span class="pre">dims</span></code> is
<code class="docutils literal"><span class="pre">{'l':</span> <span class="pre">h.size[0],</span> <span class="pre">'q':</span> <span class="pre">[],</span> <span class="pre">'s':</span> <span class="pre">[]}</span></code>, i.e., the default
assumption is that the linear inequalities are componentwise
inequalities.</p>
<p>The role of the optional argument <code class="docutils literal"><span class="pre">kktsolver</span></code> is explained in the
section <a class="reference internal" href="#s-nlcp"><span>Exploiting Structure</span></a>.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code> returns a dictionary that contains the result and
information about the accuracy of the solution.  The most important
fields have keys <code class="xref py py-const docutils literal"><span class="pre">'status'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>.
The possible values of the <code class="xref py py-const docutils literal"><span class="pre">'status'</span></code> key are:</p>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">'optimal'</span></code></dt>
<dd><p class="first">In this case the <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code> entry of the dictionary is the primal
optimal solution, the <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code> and <code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code> entries are
the corresponding slacks in the nonlinear and linear inequality
constraints, and the <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>, and
<code class="xref py py-const docutils literal"><span class="pre">'y'</span></code> entries are the optimal values of the dual variables
associated with the nonlinear inequalities, the linear
inequalities, and the linear equality constraints.  These vectors
approximately satisfy the Karush-Kuhn-Tucker (KKT) conditions</p>
<div class="last math">
<p><img src="_images/math/da6c2abaedd5a781e19aa98607eca6a3d15288f5.png" alt="c +  Df(x)^T z_\mathrm{nl} + G^T z_\mathrm{l} + A^T y = 0,

f(x) + s_\mathrm{nl} = 0, \quad k=1,\ldots,m, \qquad
    Gx + s_\mathrm{l} = h, \qquad Ax = b,


s_\mathrm{nl}\succeq 0, \qquad s_\mathrm{l}\succeq 0, \qquad
    z_\mathrm{nl} \succeq 0, \qquad z_\mathrm{l} \succeq 0,

s_\mathrm{nl}^T z_\mathrm{nl} +  s_\mathrm{l}^T z_\mathrm{l}
    = 0."/></p>
</div></dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'unknown'</span></code></dt>
<dd>This indicates that the algorithm terminated before a solution was
found, due to numerical difficulties or because the maximum number
of iterations was reached.  The <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>
entries contain the iterates when the algorithm terminated.</dd>
</dl>
<p>The other entries in the output dictionary describe the accuracy
of the solution.  The entries <code class="xref py py-const docutils literal"><span class="pre">'primal</span> <span class="pre">objective'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'dual</span> <span class="pre">objective'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'gap'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'relative</span> <span class="pre">gap'</span></code>     give the primal objective <img class="math" src="_images/math/567d706970f5fafe73762cfb27d1c51c65bd49e2.png" alt="c^Tx"/>, the dual objective, calculated
as</p>
<div class="math">
<p><img src="_images/math/d555fc582c6ae0fbb92f32567d87578eafa2be7a.png" alt="c^Tx + z_\mathrm{nl}^T f(x) + z_\mathrm{l}^T (Gx - h) + y^T(Ax-b),"/></p>
</div><p>the duality gap</p>
<div class="math">
<p><img src="_images/math/50793b5b6c2d777f66cf1b8e1671fba966b2fb3c.png" alt="s_\mathrm{nl}^T z_\mathrm{nl} +  s_\mathrm{l}^T z_\mathrm{l},"/></p>
</div><p>and the relative gap.  The relative gap is defined as</p>
<div class="math">
<p><img src="_images/math/7dc222c37caf762ab8bae6587603cc12a151bb17.png" alt="\frac{\mbox{gap}}{-\mbox{primal objective}}
    \quad \mbox{if\ } \mbox{primal objective} &lt; 0, \qquad
\frac{\mbox{gap}}{\mbox{dual objective}}
    \quad \mbox{if\ } \mbox{dual objective} &gt; 0,"/></p>
</div><p>and <code class="xref py py-const docutils literal"><span class="pre">None</span></code> otherwise.  The entry with key
<code class="xref py py-const docutils literal"><span class="pre">'primal</span> <span class="pre">infeasibility'</span></code> gives the residual in the primal
constraints,</p>
<div class="math">
<p><img src="_images/math/9f7ae16df27305a288220a25c67fec281582a178.png" alt="\newcommand{\ones}{{\bf 1}}
\frac{\| ( f(x) + s_{\mathrm{nl}},  Gx + s_\mathrm{l} - h,
    Ax-b ) \|_2} {\max\{1, \| ( f(x_0) + \ones,
Gx_0 + \ones-h, Ax_0-b) \|_2 \}}"/></p>
</div><p>where <img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> is the point returned by <code class="docutils literal"><span class="pre">F()</span></code>.  The entry
with key <code class="xref py py-const docutils literal"><span class="pre">'dual</span> <span class="pre">infeasibility'</span></code> gives the residual</p>
<div class="math">
<p><img src="_images/math/148494def4743e19b6ace5db936a26f5bf2a66ad.png" alt="\newcommand{\ones}{{\bf 1}}
\frac
    { \| c +  Df(x)^Tz_\mathrm{nl} + G^Tz_\mathrm{l} + A^T y \|_2}
    { \max\{ 1, \| c + Df(x_0)^T\ones + G^T\ones \|_2 \} }."/></p>
</div><p><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code> requires that the problem is strictly primal and dual
feasible and that</p>
<div class="math">
<p><img src="_images/math/f2cfc079aca0e287101d38af0c5399937658a911.png" alt="\newcommand{\Rank}{\mathop{\bf rank}}
\Rank(A) = p, \qquad
\Rank\left(\left[\begin{array}{cccccc}
    \sum_{k=0}^{m-1} z_k \nabla^2 f_k(x) &amp; A^T &amp;
    \nabla f_0(x) &amp; \cdots \nabla f_{m-1}(x) &amp; G^T
    \end{array}\right]\right) = n,"/></p>
</div><p>for all <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and all positive <img class="math" src="_images/math/84d7271dd9e78c1e05d6c3c6ecb60309ef7dfc73.png" alt="z"/>.</p>
</dd></dl>

<dl class="docutils">
<dt><strong>Example: floor planning</strong></dt>
<dd><p class="first">This example is the floor planning problem of section 8.8.2 in the book
<a class="reference external" href="http://www.stanford.edu/~boyd/cvxbook">Convex Optimization</a>:</p>
<div class="math">
<p><img src="_images/math/375dade287d6d8a7f17747b4bbf7b248b1df901d.png" alt="\begin{array}{ll}
\mbox{minimize}    &amp; W + H \\
\mbox{subject to}
    &amp; A_{\mathrm{min}, k}/h_k - w_k \leq 0, \quad k=1,\ldots, 5 \\
    &amp; x_1 \geq 0, \quad x_2 \geq 0,  \quad x_4 \geq 0 \\
    &amp; x_1 + w_1 + \rho \leq x_3, \quad x_2 + w_2 + \rho \leq x_3,
      \quad x_3 + w_3 + \rho \leq x_5,  \\
    &amp; x_4 + w_4 + \rho \leq x_5, \quad x_5 + w_5 \leq W \\
    &amp; y_2 \geq 0,  \quad y_3 \geq 0, \quad y_5 \geq 0  \\
    &amp; y_2 + h_2 + \rho \leq y_1, \quad y_1 + h_1 + \rho \leq y_4,
      y_3 + h_3 + \rho \leq y_4, \\
    &amp; y_4 + h_4 \leq H, \quad y_5 + h_5 \leq H \\
    &amp; h_k/\gamma \leq w_k \leq \gamma h_k, \quad k=1,\ldots,5.
\end{array}"/></p>
</div><p>This problem has 22 variables</p>
<div class="math">
<p><img src="_images/math/80f4968bb0812d8fd7b7d0d6168a86820b0a7ec7.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
W, \qquad H, \qquad x\in\reals^5, \qquad y\in\reals^5, \qquad
w\in\reals^5, \qquad h\in\reals^5,"/></p>
</div><p>5 nonlinear inequality constraints, and 26 linear inequality
constraints.  The code belows defines a function <code class="xref py py-func docutils literal"><span class="pre">floorplan</span></code>
that solves the problem by calling <code class="xref py py-func docutils literal"><span class="pre">cp</span></code>, then applies it to
4 instances, and creates a figure.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pylab</span>
<span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">solvers</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">spmatrix</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">div</span>

<span class="k">def</span> <span class="nf">floorplan</span><span class="p">(</span><span class="n">Amin</span><span class="p">):</span>

    <span class="c">#     minimize    W+H</span>
    <span class="c">#     subject to  Amink / hk &lt;= wk, k = 1,..., 5</span>
    <span class="c">#                 x1 &gt;= 0,  x2 &gt;= 0, x4 &gt;= 0</span>
    <span class="c">#                 x1 + w1 + rho &lt;= x3</span>
    <span class="c">#                 x2 + w2 + rho &lt;= x3</span>
    <span class="c">#                 x3 + w3 + rho &lt;= x5</span>
    <span class="c">#                 x4 + w4 + rho &lt;= x5</span>
    <span class="c">#                 x5 + w5 &lt;= W</span>
    <span class="c">#                 y2 &gt;= 0,  y3 &gt;= 0,  y5 &gt;= 0</span>
    <span class="c">#                 y2 + h2 + rho &lt;= y1</span>
    <span class="c">#                 y1 + h1 + rho &lt;= y4</span>
    <span class="c">#                 y3 + h3 + rho &lt;= y4</span>
    <span class="c">#                 y4 + h4 &lt;= H</span>
    <span class="c">#                 y5 + h5 &lt;= H</span>
    <span class="c">#                 hk/gamma &lt;= wk &lt;= gamma*hk,  k = 1, ..., 5</span>
    <span class="c">#</span>
    <span class="c"># 22 Variables W, H, x (5), y (5), w (5), h (5).</span>
    <span class="c">#</span>
    <span class="c"># W, H:  scalars; bounding box width and height</span>
    <span class="c"># x, y:  5-vectors; coordinates of bottom left corners of blocks</span>
    <span class="c"># w, h:  5-vectors; widths and heigths of the 5 blocks</span>

    <span class="n">rho</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span>   <span class="c"># min spacing, min aspect ratio</span>

    <span class="c"># The objective is to minimize W + H.  There are five nonlinear</span>
    <span class="c"># constraints</span>
    <span class="c">#</span>
    <span class="c">#     -wk + Amink / hk &lt;= 0,  k = 1, ..., 5</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">20</span><span class="o">*</span><span class="p">[</span><span class="mf">0.0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="k">return</span> <span class="mi">5</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">:])</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>  <span class="k">return</span> <span class="bp">None</span>
        <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="o">+</span> <span class="n">div</span><span class="p">(</span><span class="n">Amin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">:])</span>
        <span class="n">Df</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
        <span class="n">Df</span><span class="p">[:,</span><span class="mi">12</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">Df</span><span class="p">[:,</span><span class="mi">17</span><span class="p">:]</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">(</span><span class="o">-</span><span class="n">div</span><span class="p">(</span><span class="n">Amin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">:]</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">spmatrix</span><span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span> <span class="n">mul</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">div</span><span class="p">(</span><span class="n">Amin</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="mi">17</span><span class="p">::]</span><span class="o">**</span><span class="mi">3</span><span class="p">)),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">22</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">Df</span><span class="p">,</span> <span class="n">H</span>

    <span class="n">G</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="mi">26</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                       <span class="c"># -x1 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                       <span class="c"># -x2 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                       <span class="c"># -x4 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>     <span class="c"># x1 - x3 + w1 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>     <span class="c"># x2 - x3 + w2 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>     <span class="c"># x3 - x5 + w3 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>     <span class="c"># x4 - x5 + w4 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>                   <span class="c"># -W + x5 + w5 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                       <span class="c"># -y2 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                       <span class="c"># -y3 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>                                     <span class="c"># -y5 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">18</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>   <span class="c"># -y1 + y2 + h2 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>  <span class="c">#  y1 - y4 + h1 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">]],</span> <span class="n">h</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="o">-</span><span class="n">rho</span>  <span class="c">#  y3 - y4 + h3 &lt;= -rho</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>                 <span class="c"># -H + y4 + h4 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">21</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>                 <span class="c"># -H + y5 + h5 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">gamma</span>                   <span class="c"># -w1 + h1/gamma &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span>                       <span class="c">#  w1 - gamma * h1 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">gamma</span>                   <span class="c"># -w2 + h2/gamma &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">19</span><span class="p">,</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">18</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span>                       <span class="c">#  w2 - gamma * h2 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">18</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">gamma</span>                   <span class="c"># -w3 + h3/gamma &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">19</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span>                       <span class="c">#  w3 - gamma * h3 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">gamma</span>                   <span class="c"># -w4  + h4/gamma &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span>                       <span class="c">#  w4 - gamma * h4 &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">gamma</span>                   <span class="c"># -w5 + h5/gamma &lt;= 0</span>
    <span class="n">G</span><span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="n">gamma</span>                       <span class="c">#  w5 - gamma * h5 &lt;= 0.0</span>

    <span class="c"># solve and return W, H, x, y, w, h</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solvers</span><span class="o">.</span><span class="n">cpl</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">7</span><span class="p">:</span><span class="mi">12</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">12</span><span class="p">:</span><span class="mi">17</span><span class="p">],</span> <span class="n">sol</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">][</span><span class="mi">17</span><span class="p">:]</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">Amin</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">])</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span>  <span class="n">floorplan</span><span class="p">(</span><span class="n">Amin</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span>
               <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s">&#39;#D0D0D0&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">Amin</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">150.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">])</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span>  <span class="n">floorplan</span><span class="p">(</span><span class="n">Amin</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span>
               <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="s">&#39;facecolor = #D0D0D0&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">Amin</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mf">180.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">,</span> <span class="mf">80.</span><span class="p">])</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span>  <span class="n">floorplan</span><span class="p">(</span><span class="n">Amin</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span>
               <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="s">&#39;facecolor = #D0D0D0&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">Amin</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">150.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">,</span> <span class="mf">110.</span><span class="p">])</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span>  <span class="n">floorplan</span><span class="p">(</span><span class="n">Amin</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">fill</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span>
               <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="s">&#39;facecolor = #D0D0D0&#39;</span><span class="p">)</span>
    <span class="n">pylab</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">+.</span><span class="mi">5</span><span class="o">*</span><span class="n">h</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s">&quot;</span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">26</span><span class="p">])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">pylab</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>

<span class="n">pylab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="last reference internal image-reference" href="_images/floorplan.png"><img alt="_images/floorplan.png" src="_images/floorplan.png" style="width: 600px;" /></a>
</dd>
</dl>
</div>
<div class="section" id="geometric-programming">
<span id="s-gp"></span><h2>Geometric Programming<a class="headerlink" href="#geometric-programming" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="cvxopt.solvers.gp">
<code class="descclassname">cvxopt.solvers.</code><code class="descname">gp</code><span class="sig-paren">(</span><em>K</em>, <em>F</em>, <em>g</em><span class="optional">[</span>, <em>G</em>, <em>h</em><span class="optional">[</span>, <em>A</em>, <em>b</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#cvxopt.solvers.gp" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves a geometric program in convex form</p>
<div class="math">
<p><img src="_images/math/57e1fde7720d12084876914987a2765e33c23e13.png" alt="\newcommand{\lse}{\mathop{\mathbf{lse}}}
\begin{array}{ll}
\mbox{minimize}   &amp; f_0(x) = \lse(F_0x+g_0) \\
\mbox{subject to} &amp; f_i(x) = \lse(F_ix+g_i) \leq 0,
                    \quad i=1,\ldots,m \\
                  &amp; Gx \preceq h \\
                  &amp; Ax=b
\end{array}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/7aa3098b904c11d68c01bd6694f9d3e363d53b88.png" alt="\newcommand{\lse}{\mathop{\mathbf{lse}}}
\lse(u) = \log \sum_k \exp(u_k), \qquad
F = \left[ \begin{array}{cccc}
     F_0^T &amp; F_1^T &amp; \cdots &amp; F_m^T
    \end{array}\right]^T, \qquad
g = \left[ \begin{array}{cccc}
     g_0^T &amp; g_1^T &amp; \cdots &amp; g_m^T
    \end{array}\right]^T,"/></p>
</div><p>and the vector inequality denotes componentwise inequality.
<code class="docutils literal"><span class="pre">K</span></code> is a list of <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> + 1 positive integers with <code class="docutils literal"><span class="pre">K[i]</span></code>
equal to the number of rows in <img class="math" src="_images/math/d07b4c16d04b6739df29c10f32dfc4b946061922.png" alt="F_i"/>.  <code class="docutils literal"><span class="pre">F</span></code> is a dense or
sparse real matrix of size <code class="docutils literal"><span class="pre">(sum(K),</span> <span class="pre">n)</span></code>.
<code class="docutils literal"><span class="pre">g</span></code> is a dense real matrix with one column and the same number of
rows as <code class="docutils literal"><span class="pre">F</span></code>.
<code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">A</span></code> are dense or sparse real matrices.  Their default
values are sparse matrices with zero rows.
<code class="docutils literal"><span class="pre">h</span></code> and <code class="docutils literal"><span class="pre">b</span></code> are dense real matrices with one column.  Their
default values are matrices of size (0, 1).</p>
<p><code class="xref py py-func docutils literal"><span class="pre">gp</span></code> returns a dictionary with keys <code class="xref py py-const docutils literal"><span class="pre">'status'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>.  The possible values of the
<code class="xref py py-const docutils literal"><span class="pre">'status'</span></code> key are:</p>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">'optimal'</span></code></dt>
<dd><p class="first">In this case the <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code> entry is the primal optimal solution,
the <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code> and <code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code> entries are the corresponding
slacks in the nonlinear and linear inequality constraints.  The
<code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code> entries are the
optimal values of the dual variables associated with the nonlinear
and linear inequality constraints and the linear equality
constraints.  These values approximately satisfy</p>
<div class="last math">
<p><img src="_images/math/f50d3a495c7268eacf7f28116e0737ea5744d856.png" alt="\nabla f_0(x) + \sum_{k=1}^m z_{\mathrm{nl},k}
    \nabla f_k(x) + G^T z_\mathrm{l} + A^T y = 0,

f_k(x) + s_{\mathrm{nl},k} = 0, \quad k = 1,\ldots,m
\qquad Gx + s_\mathrm{l} = h, \qquad Ax = b,

s_\mathrm{nl}\succeq 0, \qquad s_\mathrm{l}\succeq 0, \qquad
z_\mathrm{nl} \succeq 0, \qquad z_\mathrm{l} \succeq 0,

s_\mathrm{nl}^T z_\mathrm{nl} + s_\mathrm{l}^T z_\mathrm{l} =0."/></p>
</div></dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'unknown'</span></code></dt>
<dd>This indicates that the algorithm terminated before a solution was
found, due to numerical difficulties or because the maximum number
of iterations was reached.  The <code class="xref py py-const docutils literal"><span class="pre">'x'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'snl'</span></code>,
<code class="xref py py-const docutils literal"><span class="pre">'sl'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'y'</span></code>, <code class="xref py py-const docutils literal"><span class="pre">'znl'</span></code>, and <code class="xref py py-const docutils literal"><span class="pre">'zl'</span></code>
contain the iterates when the algorithm terminated.</dd>
</dl>
<p>The other entries in the output dictionary describe the accuracy
of the solution, and are taken from the output of
<a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a>.</p>
</dd></dl>

<p>As an example, we solve the small GP of section 2.4 of the paper
<a class="reference external" href="http://www.stanford.edu/~boyd/gp_tutorial.html">A Tutorial on Geometric Programming</a>.
The  posynomial form of the problem is</p>
<div class="math">
<p><img src="_images/math/4e08ab76044c33b5ec9ded78921ddc90d3385668.png" alt="\begin{array}{ll}
\mbox{minimize}
    &amp; w^{-1} h^{-1} d^{-1} \\
\mbox{subject to}
    &amp; (2/A_\mathrm{wall}) hw + (2/A_\mathrm{wall})hd \leq 1  \\
    &amp;  (1/A_\mathrm{flr}) wd \leq 1 \\
    &amp;  \alpha wh^{-1} \leq 1 \\
    &amp;  (1/\beta) hw^{-1} \leq 1 \\
    &amp;  \gamma wd^{-1} \leq 1 \\
    &amp;   (1/\delta)dw^{-1} \leq 1
 \end{array}"/></p>
</div><p>with variables <img class="math" src="_images/math/cbb80ad77aa7a5e227d5a46bc44d235284106cfc.png" alt="h"/>, <img class="math" src="_images/math/8659700e6646cd91bc02c32affaa5ec046ee9935.png" alt="w"/>, <img class="math" src="_images/math/425d86ba2f2979d75b7535c2bcf92c33ed6b285a.png" alt="d"/>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">solvers</span>

<span class="n">Aflr</span>  <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">Awall</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">beta</span>  <span class="o">=</span> <span class="mf">2.0</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">]])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span> <span class="n">matrix</span><span class="p">(</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="n">Awall</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="n">Awall</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Aflr</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">delta</span><span class="p">])</span> <span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span> <span class="n">solvers</span><span class="o">.</span><span class="n">gp</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">g</span><span class="p">)[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="exploiting-structure">
<span id="s-nlcp"></span><h2>Exploiting Structure<a class="headerlink" href="#exploiting-structure" title="Permalink to this headline">¶</a></h2>
<p>By default, the functions <a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> and
<a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a> do not exploit problem
structure.  Two mechanisms are provided for implementing customized solvers
that take advantage of problem structure.</p>
<dl class="docutils">
<dt><strong>Providing a function for solving KKT equations</strong></dt>
<dd><p class="first">The most expensive step of each iteration of
<a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> is the
solution of a set of linear equations (<em>KKT equations</em>) of the form</p>
<div class="math" id="equation-e-cp-kkt">
<p><span class="eqno">(2)</span><img src="_images/math/094605c7610159f1037e4198872755402bd03b31.png" alt="\left[\begin{array}{ccc}
    H        &amp; A^T &amp; \tilde G^T \\
    A        &amp; 0   &amp; 0  \\
    \tilde G &amp; 0   &amp; -W^T W
\end{array}\right]
\left[\begin{array}{c} u_x \\ u_y \\ u_z \end{array}\right]
=
\left[\begin{array}{c} b_x \\ b_y \\ b_z \end{array}\right],"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/f8a049b96970ce863efb8a9f7b40c855f0422d56.png" alt="H = \sum_{k=0}^m z_k \nabla^2f_k(x), \qquad
\tilde G = \left[\begin{array}{cccc}
\nabla f_1(x) &amp; \cdots &amp; \nabla f_m(x) &amp; G^T \end{array}\right]^T."/></p>
</div><p>The matrix <img class="math" src="_images/math/fa34489cf430b7630b30f28b2eb050e2489e3523.png" alt="W"/> depends on the current iterates and is defined as
follows.  Suppose</p>
<div class="math">
<p><img src="_images/math/29c80fb76aef86553d6995b91b53d323a778d299.png" alt="\newcommand{\svec}{\mathop{\mathbf{vec}}}
u = \left( u_\mathrm{nl}, \; u_\mathrm{l}, \; u_{\mathrm{q},0}, \;
    \ldots, \; u_{\mathrm{q},M-1}, \; \svec{(u_{\mathrm{s},0})}, \;
    \ldots, \; \svec{(u_{\mathrm{s},N-1})} \right), \qquad"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/42c237a9ee94ebc91e1cbec07638f3d32626b9c8.png" alt="\newcommand{\reals}{{\mbox{\bf R}}}
\newcommand{\symm}{{\mbox{\bf S}}}
u_\mathrm{nl} \in \reals^m, \qquad
u_\mathrm{l} \in \reals^l, \qquad
u_{\mathrm{q},k} \in \reals^{r_k}, \quad k = 0, \ldots, M-1,
\qquad
u_{\mathrm{s},k} \in \symm^{t_k},  \quad k = 0, \ldots, N-1."/></p>
</div><p>Then <img class="math" src="_images/math/fa34489cf430b7630b30f28b2eb050e2489e3523.png" alt="W"/> is a block-diagonal matrix,</p>
<div class="math">
<p><img src="_images/math/31f8cf9a37fad96d43492022e560df7d32ef2026.png" alt="\newcommand{\svec}{\mathop{\mathbf{vec}}}
Wu = \left( W_\mathrm{nl} u_\mathrm{nl}, \;
     W_\mathrm{l} u_\mathrm{l}, \;
     W_{\mathrm{q},0} u_{\mathrm{q},0}, \; \ldots, \;
     W_{\mathrm{q},M-1} u_{\mathrm{q},M-1},\;
     W_{\mathrm{s},0} \svec{(u_{\mathrm{s},0})}, \; \ldots, \;
     W_{\mathrm{s},N-1} \svec{(u_{\mathrm{s},N-1})} \right)"/></p>
</div><p>with the following diagonal blocks.</p>
<ul>
<li><p class="first">The first block is a <em>positive diagonal scaling</em> with a vector
<img class="math" src="_images/math/6dc95523d22428403e9ec3e7f37e26ea270bf4dc.png" alt="d_{\mathrm{nl}}"/>:</p>
<div class="math">
<p><img src="_images/math/a5d6a9ffacc01b68b780618818cbd90474466cc9.png" alt="\newcommand{\diag}{\mbox{\bf diag}\,}
W_\mathrm{nl} = \diag(d_\mathrm{nl}), \qquad
W_\mathrm{nl}^{-1} = \diag(d_\mathrm{nl})^{-1}."/></p>
</div><p>This transformation is symmetric:</p>
<div class="math">
<p><img src="_images/math/b9237e06a8e6e906a69ec6acdc633603ba50084b.png" alt="W_\mathrm{nl}^T = W_\mathrm{nl}."/></p>
</div></li>
<li><p class="first">The second block is a <em>positive diagonal scaling</em> with a vector
<img class="math" src="_images/math/06b423cebfb90c3d0a63b7f3df78c09d995cfeaa.png" alt="d_{\mathrm{l}}"/>:</p>
<div class="math">
<p><img src="_images/math/f4136218c7316891923eb92e8e53da9c884ba7da.png" alt="\newcommand{\diag}{\mbox{\bf diag}\,}
W_\mathrm{l} = \diag(d_\mathrm{l}), \qquad
W_\mathrm{l}^{-1} = \diag(d_\mathrm{l})^{-1}."/></p>
</div><p>This transformation is symmetric:</p>
<div class="math">
<p><img src="_images/math/a54708fe7e95067497dd42cdf40c2b0c8023b956.png" alt="W_\mathrm{l}^T = W_\mathrm{l}."/></p>
</div></li>
<li><p class="first">The next <img class="math" src="_images/math/2de38926392ba23abeac75effc66c37a5f5be5fd.png" alt="M"/> blocks are positive multiples of <em>hyperbolic
Householder transformations</em>:</p>
<div class="math">
<p><img src="_images/math/b94be0ad0fc90fa2e4e61c0c2c094ebc202d7729.png" alt="W_{\mathrm{q},k} = \beta_k ( 2 v_k v_k^T - J), \qquad
W_{\mathrm{q},k}^{-1} = \frac{1}{\beta_k} ( 2 Jv_k v_k^T J - J),
\qquad k = 0,\ldots,M-1,"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/0246a989dbd0daa3dc3c6fecbf683b226a79b7f1.png" alt="\beta_k &gt; 0, \qquad v_{k0} &gt; 0, \qquad v_k^T Jv_k = 1, \qquad
J = \left[\begin{array}{cc} 1 &amp; 0 \\ 0 &amp; -I \end{array}\right]."/></p>
</div><p>These transformations are also symmetric:</p>
<div class="math">
<p><img src="_images/math/52031bf68ee42296146e8a3e4f5033b6173dcf51.png" alt="W_{\mathrm{q},k}^T = W_{\mathrm{q},k}."/></p>
</div></li>
<li><p class="first">The last <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> blocks are <em>congruence transformations</em> with
nonsingular matrices:</p>
<div class="math">
<p><img src="_images/math/10d982174e5e28e1a59619b7cfa9c3e0c25b4a6b.png" alt="\newcommand{\svec}{\mathop{\mathbf{vec}}}
W_{\mathrm{s},k} \svec{(u_{\mathrm{s},k})} =
    \svec{(r_k^T u_{\mathrm{s},k} r_k)}, \qquad
W_{\mathrm{s},k}^{-1} \svec{(u_{\mathrm{s},k})} =
   \svec{(r_k^{-T} u_{\mathrm{s},k} r_k^{-1})}, \qquad
k = 0,\ldots,N-1."/></p>
</div><p>In  general, this operation is not symmetric, and</p>
<div class="math">
<p><img src="_images/math/0260007688027eacd5a07f14d9365f85f5c8ee95.png" alt="\newcommand{\svec}{\mathop{\mathbf{vec}}}
W_{\mathrm{s},k}^T \svec{(u_{\mathrm{s},k})} =
    \svec{(r_k u_{\mathrm{s},k} r_k^T)}, \qquad
\qquad
W_{\mathrm{s},k}^{-T} \svec{(u_{\mathrm{s},k})} =
    \svec{(r_k^{-1} u_{\mathrm{s},k} r_k^{-T})}, \qquad
k = 0,\ldots,N-1."/></p>
</div></li>
</ul>
<p>It is often possible to exploit problem structure to solve
<a href="#equation-e-cp-kkt">(2)</a> faster than by standard methods.  The last argument
<code class="docutils literal"><span class="pre">kktsolver</span></code> of <a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> allows the user to
supply a Python function
for solving the KKT equations.  This function will be called as
<code class="docutils literal"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">kktsolver(x,</span> <span class="pre">z,</span> <span class="pre">W)</span></code>.  The argument <code class="docutils literal"><span class="pre">x</span></code> is the point at
which the derivatives in the KKT matrix are evaluated.  <code class="docutils literal"><span class="pre">z</span></code> is a
positive vector of length it <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> + 1, containing the coefficients
in the 1,1 block <img class="math" src="_images/math/48f75e0b463f2fdb7fca9566cffdc439cae6967f.png" alt="H"/>.  <code class="docutils literal"><span class="pre">W</span></code> is a dictionary that contains the
parameters of the scaling:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">W['dnl']</span></code> is the positive vector that defines the diagonal
scaling for the nonlinear inequalities.  <code class="docutils literal"><span class="pre">W['dnli']</span></code> is its
componentwise inverse.</li>
<li><code class="docutils literal"><span class="pre">W['d']</span></code> is the positive vector that defines the diagonal
scaling for the componentwise linear inequalities.  <code class="docutils literal"><span class="pre">W['di']</span></code>
is its componentwise inverse.</li>
<li><code class="docutils literal"><span class="pre">W['beta']</span></code> and <code class="docutils literal"><span class="pre">W['v']</span></code> are lists of length <img class="math" src="_images/math/2de38926392ba23abeac75effc66c37a5f5be5fd.png" alt="M"/>
with the coefficients and vectors that define the hyperbolic
Householder transformations.</li>
<li><code class="docutils literal"><span class="pre">W['r']</span></code> is a list of length <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> with the matrices that
define the the congruence transformations.  <code class="docutils literal"><span class="pre">W['rti']</span></code> is a
list of length <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> with the transposes of the inverses of the
matrices in <code class="docutils literal"><span class="pre">W['r']</span></code>.</li>
</ul>
<p>The function call <code class="docutils literal"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">kktsolver(x,</span> <span class="pre">z,</span> <span class="pre">W)</span></code> should return a
routine for solving the KKT system <a href="#equation-e-cp-kkt">(2)</a> defined by <code class="docutils literal"><span class="pre">x</span></code>,
<code class="docutils literal"><span class="pre">z</span></code>, <code class="docutils literal"><span class="pre">W</span></code>.  It will be called as <code class="docutils literal"><span class="pre">f(bx,</span> <span class="pre">by,</span> <span class="pre">bz)</span></code>.
On entry, <code class="docutils literal"><span class="pre">bx</span></code>, <code class="docutils literal"><span class="pre">by</span></code>, <code class="docutils literal"><span class="pre">bz</span></code> contain the right-hand side.  On exit,
they should contain the solution of the KKT system, with the last
component scaled, i.e., on exit,</p>
<div class="math">
<p><img src="_images/math/c7c0674ced05ddaa94bd705d1a836882a49c5b85.png" alt="b_x := u_x, \qquad b_y := u_y, \qquad b_z := W u_z."/></p>
</div><p>The role of the argument <code class="docutils literal"><span class="pre">kktsolver</span></code> in the function
<a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a> is similar, except that in
<a href="#equation-e-cp-kkt">(2)</a>,</p>
<div class="last math">
<p><img src="_images/math/e685fdf1ecd460e241aacbbd6d1accbc12cc5829.png" alt="H = \sum_{k=0}^{m-1} z_k \nabla^2f_k(x), \qquad
\tilde G = \left[\begin{array}{cccc}
\nabla f_0(x) &amp; \cdots &amp; \nabla f_{m-1}(x) &amp; G^T \end{array}\right]^T."/></p>
</div></dd>
<dt><strong>Specifying constraints via Python functions</strong></dt>
<dd><p class="first">In the default use of <a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a>, the arguments
<code class="docutils literal"><span class="pre">G</span></code> and <code class="docutils literal"><span class="pre">A</span></code> are the
coefficient matrices in the constraints of <a href="#equation-e-cp-kkt">(2)</a>.  It is also
possible to specify these matrices by providing Python functions that
evaluate the corresponding matrix-vector products and their adjoints.</p>
<ul>
<li><p class="first">If the argument <code class="docutils literal"><span class="pre">G</span></code> of <code class="xref py py-func docutils literal"><span class="pre">cp</span></code> is a Python function, then
<code class="docutils literal"><span class="pre">G(u,</span> <span class="pre">v[,</span> <span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">1.0,</span> <span class="pre">beta</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">trans</span> <span class="pre">=</span> <span class="pre">'N'])</span></code> should
evaluates the matrix-vector products</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/a561f265b36883ab4d6de8f9669351888a2373ed.png" alt="v := \alpha Gu + \beta v \quad
    (\mathrm{trans} = \mathrm{'N'}), \qquad
v := \alpha G^T u + \beta v \quad
   (\mathrm{trans} = \mathrm{'T'})."/></p>
</div></div></blockquote>
</li>
<li><p class="first">Similarly, if the argument <code class="docutils literal"><span class="pre">A</span></code> is a Python function, then
<code class="docutils literal"><span class="pre">A(u,</span> <span class="pre">v[,</span> <span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">1.0,</span> <span class="pre">beta</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">trans</span> <span class="pre">=</span> <span class="pre">'N'])</span></code> should
evaluate the matrix-vector products</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/b828151fe9afd4446b89b49af5391342a5012fa7.png" alt="v \alpha Au + \beta v \quad
    (\mathrm{trans} = \mathrm{'N'}), \qquad
v := \alpha A^T u + \beta v \quad
    (\mathrm{trans} = \mathrm{'T'})."/></p>
</div></div></blockquote>
</li>
<li><p class="first">In a similar way, when the first argument <code class="docutils literal"><span class="pre">F</span></code> of
<a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> returns matrices of first
derivatives or second derivatives <code class="docutils literal"><span class="pre">Df</span></code>, <code class="docutils literal"><span class="pre">H</span></code>, these matrices can
be specified as Python functions.  If <code class="docutils literal"><span class="pre">Df</span></code> is a Python function,
then <code class="docutils literal"><span class="pre">Df(u,</span> <span class="pre">v[,</span> <span class="pre">alpha</span> <span class="pre">=</span> <span class="pre">1.0,</span> <span class="pre">beta</span> <span class="pre">=</span> <span class="pre">0.0,</span> <span class="pre">trans</span> <span class="pre">=</span> <span class="pre">'N'])</span></code> should
evaluate the matrix-vector products</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/77aec2862da28625ff641e3f560e157fbd895a2b.png" alt="v := \alpha Df(x) u + \beta v \quad
    (\mathrm{trans} = \mathrm{'N'}), \qquad
v := \alpha Df(x)^T u + \beta v \quad
    (\mathrm{trans} = \mathrm{'T'})."/></p>
</div></div></blockquote>
<p>If <code class="docutils literal"><span class="pre">H</span></code> is a Python function, then <code class="docutils literal"><span class="pre">H(u,</span> <span class="pre">v[,</span> <span class="pre">alpha,</span> <span class="pre">beta])</span></code> should
evaluate the matrix-vector product</p>
<blockquote>
<div><div class="math">
<p><img src="_images/math/c3bb2dbfdf9313d0d369ef7ac0c4c2b58f310d92.png" alt="v := \alpha H u + \beta v."/></p>
</div></div></blockquote>
</li>
</ul>
<p class="last">If <code class="docutils literal"><span class="pre">G</span></code>, <code class="docutils literal"><span class="pre">A</span></code>, <code class="docutils literal"><span class="pre">Df</span></code>, or <code class="docutils literal"><span class="pre">H</span></code> are Python functions, then the
argument <code class="docutils literal"><span class="pre">kktsolver</span></code> must also be provided.</p>
</dd>
</dl>
<p>As an example, we consider the unconstrained problem</p>
<div class="math">
<p><img src="_images/math/224ac4b02649eeb43b4743cc553d4d9f6651a86d.png" alt="\begin{array}{ll}
\mbox{minimize} &amp; (1/2)\|Ax-b\|_2^2 - \sum_{i=1}^n \log(1-x_i^2)
\end{array}"/></p>
</div><p>where <img class="math" src="_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/> is an <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> by <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> matrix with <img class="math" src="_images/math/c4bb40dd65eae6c11b325989b14e0b8d35e4e3ef.png" alt="m"/> less
than <img class="math" src="_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>.  The Hessian of the objective is diagonal plus a low-rank
term:</p>
<div class="math">
<p><img src="_images/math/edcbd6cd73ef9909f576e6dc918b5defd822ea7d.png" alt="\newcommand{\diag}{\mbox{\bf diag}\,}
H = A^TA + \diag(d), \qquad d_i = \frac{2(1+x_i^2)}{(1-x_i^2)^2}."/></p>
</div><p>We can exploit this property when solving <a href="#equation-e-cp-kkt">(2)</a> by applying
the matrix inversion lemma. We first solve</p>
<div class="math">
<p><img src="_images/math/cfb14204c91bf302a59f79887bd459ca0ca3565a.png" alt="\newcommand{\diag}{\mbox{\bf diag}\,}
(A \diag(d)^{-1}A^T + I) v = (1/z_0) A \diag(d)^{-1}b_x, \qquad"/></p>
</div><p>and then obtain</p>
<div class="math">
<p><img src="_images/math/114653593889a8ebfb445e7026fce81d450033de.png" alt="\newcommand{\diag}{\mbox{\bf diag}\,}
u_x = \diag(d)^{-1}(b_x/z_0 - A^T v)."/></p>
</div><p>The following code follows this method.  It also uses BLAS functions
for matrix-matrix and matrix-vector products.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">spdiag</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">div</span><span class="p">,</span> <span class="n">log</span><span class="p">,</span> <span class="n">blas</span><span class="p">,</span> <span class="n">lapack</span><span class="p">,</span> <span class="n">solvers</span><span class="p">,</span> <span class="n">base</span>

<span class="k">def</span> <span class="nf">l2ac</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solves</span>

<span class="sd">        minimize  (1/2) * ||A*x-b||_2^2 - sum log (1-xi^2)</span>

<span class="sd">    assuming A is m x n with m &lt;&lt; n.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">size</span>
    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="c"># r = A*x - b</span>
        <span class="n">r</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span>
        <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">blas</span><span class="o">.</span><span class="n">nrm2</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>  <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">w</span><span class="p">))</span>
        <span class="c"># gradf = A&#39;*r + 2.0 * x ./ (1-w)</span>
        <span class="n">gradf</span> <span class="o">=</span> <span class="n">div</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">gradf</span><span class="p">,</span> <span class="n">trans</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">gradf</span><span class="o">.</span><span class="n">T</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">def</span> <span class="nf">Hf</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">):</span>
               <span class="c"># v := alpha * (A&#39;*A*u + 2*((1+w)./(1-w)).*u + beta *v</span>
               <span class="n">v</span> <span class="o">*=</span> <span class="n">beta</span>
               <span class="n">v</span> <span class="o">+=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">mul</span><span class="p">(</span><span class="n">div</span><span class="p">(</span><span class="mf">1.0</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">w</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">u</span><span class="p">)</span>
               <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
               <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">trans</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">gradf</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Hf</span>


    <span class="c"># Custom solver for the Newton system</span>
    <span class="c">#</span>
    <span class="c">#     z[0]*(A&#39;*A + D)*x = bx</span>
    <span class="c">#</span>
    <span class="c"># where D = 2 * (1+x.^2) ./ (1-x.^2).^2.  We apply the matrix inversion</span>
    <span class="c"># lemma and solve this as</span>
    <span class="c">#</span>
    <span class="c">#     (A * D^-1 *A&#39; + I) * v = A * D^-1 * bx / z[0]</span>
    <span class="c">#     D * x = bx / z[0] - A&#39;*v.</span>

    <span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">Fkkt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">div</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**-</span><span class="mf">0.5</span>
        <span class="n">Asc</span> <span class="o">=</span> <span class="n">spdiag</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span> <span class="o">*</span> <span class="n">A</span>
        <span class="n">blas</span><span class="o">.</span><span class="n">syrk</span><span class="p">(</span><span class="n">Asc</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>
        <span class="n">S</span><span class="p">[::</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
        <span class="n">lapack</span><span class="o">.</span><span class="n">potrf</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
            <span class="n">x</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span>
            <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">Asc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">lapack</span><span class="o">.</span><span class="n">potrs</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="n">blas</span><span class="o">.</span><span class="n">gemv</span><span class="p">(</span><span class="n">Asc</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">trans</span> <span class="o">=</span> <span class="s">&#39;T&#39;</span><span class="p">)</span>
            <span class="n">x</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ds</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="k">return</span> <span class="n">solvers</span><span class="o">.</span><span class="n">cp</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">kktsolver</span> <span class="o">=</span> <span class="n">Fkkt</span><span class="p">)[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="algorithm-parameters">
<span id="s-parameters2"></span><h2>Algorithm Parameters<a class="headerlink" href="#algorithm-parameters" title="Permalink to this headline">¶</a></h2>
<p>The following algorithm control parameters are accessible via the
dictionary <code class="xref py py-attr docutils literal"><span class="pre">solvers.options</span></code>.  By default the dictionary
is empty and the default values of the parameters are used.</p>
<p>One can change the parameters in the default solvers by
adding entries with the following key values.</p>
<dl class="docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">'show_progress'</span></code></dt>
<dd><code class="xref py py-const docutils literal"><span class="pre">True</span></code> or <code class="xref py py-const docutils literal"><span class="pre">False</span></code>; turns the output to the screen on or
off (default: <code class="xref py py-const docutils literal"><span class="pre">True</span></code>).</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'maxiters'</span></code></dt>
<dd>maximum number of iterations (default: <code class="xref py py-const docutils literal"><span class="pre">100</span></code>).</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'abstol'</span></code></dt>
<dd>absolute accuracy (default: <code class="xref py py-const docutils literal"><span class="pre">1e-7</span></code>).</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'reltol'</span></code></dt>
<dd>relative accuracy (default: <code class="xref py py-const docutils literal"><span class="pre">1e-6</span></code>).</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'feastol'</span></code></dt>
<dd>tolerance for feasibility conditions (default: <code class="xref py py-const docutils literal"><span class="pre">1e-7</span></code>).</dd>
<dt><code class="xref py py-const docutils literal"><span class="pre">'refinement'</span></code></dt>
<dd>number of iterative refinement steps when solving KKT equations
(default: <code class="xref py py-const docutils literal"><span class="pre">1</span></code>).</dd>
</dl>
<p>For example the command</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cvxopt</span> <span class="kn">import</span> <span class="n">solvers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solvers</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;show_progress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>turns off the screen output during calls to the solvers.  The tolerances
<code class="xref py py-const docutils literal"><span class="pre">abstol</span></code>, <code class="xref py py-const docutils literal"><span class="pre">reltol</span></code> and <code class="xref py py-const docutils literal"><span class="pre">feastol</span></code> have the
following meaning in <a class="reference internal" href="#cvxopt.solvers.cpl" title="cvxopt.solvers.cpl"><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code></a>.</p>
<p><code class="xref py py-func docutils literal"><span class="pre">cpl</span></code> returns with status <code class="xref py py-const docutils literal"><span class="pre">'optimal'</span></code> if</p>
<div class="math">
<p><img src="_images/math/4183ccded09d4e9db5fc8ffc56d52408488b005d.png" alt="\newcommand{\ones}{{\bf 1}}
\frac{\| c +  Df(x)^Tz_\mathrm{nl} + G^Tz_\mathrm{l} + A^T y \|_2 }
{\max\{ 1, \| c + Df(x_0)^T\ones + G^T\ones \|_2 \}}
\leq \epsilon_\mathrm{feas}, \qquad
\frac{\| ( f(x) + s_{\mathrm{nl}},  Gx + s_\mathrm{l} - h,
 Ax-b ) \|_2}
{\max\{1, \| ( f(x_0) + \ones,
Gx_0 + \ones-h, Ax_0-b) \|_2 \}} \leq \epsilon_\mathrm{feas}"/></p>
</div><p>where <img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> is the point returned by <code class="docutils literal"><span class="pre">F()</span></code>, and</p>
<div class="math">
<p><img src="_images/math/8ced9967cf5ac8a7dfe5907f92559a67567f9fd1.png" alt="\mathrm{gap} \leq \epsilon_\mathrm{abs}
\qquad \mbox{or} \qquad \left( c^Tx &lt; 0, \quad
\frac{\mathrm{gap}} {-c^Tx} \leq \epsilon_\mathrm{rel} \right)
\qquad \mbox{or} \qquad
\left( L(x,y,z) &gt; 0, \quad \frac{\mathrm{gap}}
{L(x,y,z)} \leq \epsilon_\mathrm{rel} \right)"/></p>
</div><p>where</p>
<div class="math">
<p><img src="_images/math/e9424ef951bc888bb64400220e3db2751194bf8e.png" alt="\mathrm{gap} =
\left[\begin{array}{c} s_\mathrm{nl} \\ s_\mathrm{l}
\end{array}\right]^T
\left[\begin{array}{c} z_\mathrm{nl} \\ z_\mathrm{l}
\end{array}\right],
\qquad
L(x,y,z) = c^Tx + z_\mathrm{nl}^T f(x) +
    z_\mathrm{l}^T (Gx-h) + y^T(Ax-b)."/></p>
</div><p>The functions <a class="reference internal" href="#cvxopt.solvers.cp" title="cvxopt.solvers.cp"><code class="xref py py-func docutils literal"><span class="pre">cp</span></code></a> and
<a class="reference internal" href="#cvxopt.solvers.gp" title="cvxopt.solvers.gp"><code class="xref py py-func docutils literal"><span class="pre">gp</span></code></a> call <code class="xref py py-func docutils literal"><span class="pre">cpl</span></code> and hence use the
same stopping criteria (with <img class="math" src="_images/math/047937fc5e1e2e82914d671ed65b71adb4401eb7.png" alt="x_0 = 0"/> for <code class="xref py py-func docutils literal"><span class="pre">gp</span></code>).</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="modeling.html" class="btn btn-neutral float-right" title="Modeling">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="coneprog.html" class="btn btn-neutral" title="Cone Programming"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="copyright.html">Copyright</a> .
      Last updated on Sep 21, 2015.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1.8',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  false
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
    <div class="footer">
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.
    </div>

</body>
</html>